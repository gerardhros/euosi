<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>EU OSI for nitrogen • euosi</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="EU OSI for nitrogen">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">euosi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/description_osi_crops_table.html">Description of osi_crops table</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_aggregation.html">EU OSI aggregation</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_for_nitrogen.html">EU OSI for nitrogen</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_for_phosphor.html">EU OSI for phosphor</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_for_potassium.html">EU OSI for potassium</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_introduction.html">EU OSI introduction</a></li>
    <li><a class="dropdown-item" href="../articles/eu_osi_variables.html">EU OSI variables</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>EU OSI for nitrogen</h1>
                        <h4 data-toc-skip class="author">Gerard Ros
&amp; Elise van Eynde</h4>
            
            <h4 data-toc-skip class="date">2025-08-15</h4>
      

      <div class="d-none name"><code>eu_osi_for_nitrogen.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Nitrogen (N) is one of the most important nutrients for plant growth,
playing a central role in proteins, enzymes, chlorophyll, and other
essential biomolecules. In soil health assessments, N is a key indicator
because it reflects both the N supplying capacity of the soil and the
functioning of the soil’s biological community. Adequate N availability
supports vigorous plant growth, while deficiencies can limit
productivity and lead to poor crop quality. However, nitrogen must be
present in balanced forms; excessive levels, particularly of nitrate,
can signal nutrient imbalances or management practices that increase
leaching and environmental losses. The soil nitrogen cycle is driven by
a complex interplay of biological, chemical, and physical processes.
Organic nitrogen in soil organic matter must be mineralized by
microorganisms into ammonium (NH₄⁺), and then further transformed
through nitrification into nitrate (NO₃⁻), which is readily available to
plants but also prone to leaching. The efficiency of these processes
depends on soil health factors such as microbial diversity, aeration,
moisture, pH, and organic matter content. A healthy soil maintains a
dynamic nitrogen cycle that meets plant needs while minimizing losses
through leaching, denitrification, or volatilization.</p>
<p>Measuring soil nitrogen provides insights not only into current
fertility status but also into the underlying biological activity and
organic matter dynamics. Tests such as total nitrogen, potentially
mineralizable nitrogen (PMN), and inorganic nitrogen fractions help
identify whether the soil can sustain crop needs throughout the growing
season. High PMN values, for instance, often indicate a well-functioning
microbial community and good organic matter quality. In contrast, low
nitrogen levels can point to degraded soils with poor biological
activity, low organic matter, or excessive nutrient losses.</p>
<p>The European Open Soil Index assesses the soil function for N supply
using the agronomic knowledge base as being used in the various EU
countries. This is done via an assessment of the microbial activity
(using the PMN test, see <code>osi_b_pmn</code>) and the N supplying
capacity (see <code>osi_c_nitrogen</code>). Both soil health indicators
are unitless and ranging between zero (poor quality) and one (optimum
quality). This indicator score reflects the ‘distance to target’
(i.e. difference between the current and optimum situation, while
ensuring that other soil functions are not limiting). The further it
deviates from score 1, the poorer the soil function works. An indicator
value of 0.5 approximately corresponds to the threshold level of the
fertilization guidelines under which (additional) fertilization is
recommended (given the ‘buildup and maintenance’ approach as being
implemented in fertilizer recommendation systems). Overall, the
indicator value can be interpreted as good (&gt;0.75), sufficient
(0.5-0.75), and poor (&lt;0.5).</p>
</div>
<div class="section level2">
<h2 id="the-soil-n-wrapper-functions">The soil N wrapper functions<a class="anchor" aria-label="anchor" href="#the-soil-n-wrapper-functions"></a>
</h2>
<p>The euosi package has two wrapper function to assess the soil health
index in view of the key role of soil nitrogen supporting crop
produciton across Europe. This implies that two soil health indicators
are caculated. The first wrapper function is <code>osi_c_nitrogen</code>
and the second one is <code>osi_b_pmn</code>. <br> The function
<code>osi_c_nitrogen</code> requires the following inputs:</p>
<ul>
<li>B_LU (character) The crop code</li>
<li>B_SOILTYPE_AGR (character) The soil type in a particular region</li>
<li>A_CLAY_MI (numeric) The clay content of the soil (%)</li>
<li>A_SAND_MI (numeric) The sand content of the soil (%)</li>
<li>A_SOM_LOI (numeric) The organic matter content of the soil (%)</li>
<li>A_C_OF (numeric) The organic carbon content in the soil (g C / kg).
Optional.</li>
<li>A_PH_CC (numeric) The pH measured in CaCl2 extraction.</li>
<li>A_CACO3_IF (numeric) the percentage of CaCO3 (%)</li>
<li>A_N_RT (numeric) The organic organic nitrogen content of the soil
(mg N / kg)</li>
<li>B_COUNTRY (character) The country code</li>
</ul>
<p><br> The function <code>osi_b_pmn</code> requires the following
inputs:</p>
<ul>
<li>B_LU (character) The crop code</li>
<li>B_SOILTYPE_AGR (character) The soil type in a particular region</li>
<li>A_CLAY_MI (numeric) The clay content of the soil (%)</li>
<li>A_N_RT (numeric) The organic organic nitrogen content of the soil
(mg N / kg)</li>
<li>A_N_PMN (numeric) The potentially mineralizable N pool (mg N / kg
soil)</li>
<li>B_COUNTRY (character) The country code</li>
</ul>
<p>The wrapper function wraps country specific N assessment functions.
In contrast to phosphorus and potassium are most of the existing N
fertilizer systems based on a simple mass balance approach using
inorganic N measurements as guide to correct for available N in soils.
The majority of the N fertilizer systems in Europe do not have an
underpinned estimate of the capacity of soils to supply N. Similarly,
the use of PMN to adjust or optimise N fertilization is quite rare in
Europe. <br> At the moment the euosi package has country specific
functions for the N supply for the Netherland, Belgium, Germany and
France. For all other countries, the euosi package uses a generic
estimation of the N supply, following a simple first order decomposition
constant of the soil organic nitrogen involved (see
<code>osi_c_nitrogen_eu</code>). Similarly, only the Netherlands
evaluate soil health using the PMN method. Also here, the euosi package
uses a generic PMN assessment method following the Dutch approach (see
<code>osi_b_pmn_eu</code>).</p>
</div>
<div class="section level2">
<h2 id="the-european-assessment-for-soil-n">The European assessment for soil N<a class="anchor" aria-label="anchor" href="#the-european-assessment-for-soil-n"></a>
</h2>
<p>To evaluate the capacity of soils to supply nitrogen, the euosi
assumes that annualy 2% of the soil organic matter is decomposed.
Following the stochiometry of the carbon and nitrogen in soil, the N
supply is calculated accordingly. A more detailed approach using RothC
modelling is also possible, but it requires far more inputs regarding
carbon and nutrients (from manure, compost, crop residues, and
exudates). For that reason we applied a more simple approach following
the classic agronomic organic matter balance. See for example the tool
being used by various farmers across Europe: <a href="www.os-balans.nl">www.os-balans.nl</a>.</p>
<p>The different steps are illustrated below. First the bulk density is
estimated using a pedotransfer function. Then an annual decomposition
rate is set at 2%. Third, the N supply is estimated from the total N
content and the annual decomposition rate. The N supply is maximised at
600 kg N/ha. We assume that around 25% of this mineralized N is
available in springg and during the early stages of growth (4 months,
assuming linearity over the year). This N mineralized is corrected for
eventual losses that occur during the winter period, and is set at 50%.
This value might be updated based on the precipitation surplus and
leaching risk (to be done). Finally this results in an estimate of the
total amount of inorganic N being available in spring. Using a logistic
scoring with an optimum of around 40 kg N/ha, we calculated the soil
health index for nitrogen.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># estimate bulk density via pedotransfer function</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">BD</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.02525</span> <span class="op">*</span> <span class="va">A_SOM_LOI</span> <span class="op">+</span> <span class="fl">0.6541</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># set annual decomposition rate of 2%</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">arate</span> <span class="op">:=</span> <span class="fl">0.02</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate N supply for top 30 cm soil layer, set at max at 600 kg / yr</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSC</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fl">600</span>,<span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">*</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">BD</span><span class="op">)</span> <span class="op">*</span> <span class="va">A_N_RT</span> <span class="op">*</span> <span class="va">arate</span> <span class="op">*</span> <span class="fl">0.001</span> <span class="op">*</span> <span class="fl">0.001</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># assume that 25% is mineralized in winter, and available in pre-season</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSCPS</span> <span class="op">:=</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">NSC</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># correction for losses (a generic 50%, might make dependent on precipitation surplus)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSCPS</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">*</span> <span class="va">NSCPS</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># convert to OSI score, optimum is 125 kg N / ha / yr</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="fu"><a href="../reference/osi_evaluate_logistic.html">osi_evaluate_logistic</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NSCPS</span>, b <span class="op">=</span> <span class="fl">0.13683559</span>, x0 <span class="op">=</span> <span class="op">-</span><span class="fl">14.84508232</span>, v <span class="op">=</span> <span class="fl">0.03487421</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>A common indicator to assess soil microbial activity is potentially
mineralizable nitrogen (PMN). PMN is the capacity of soil microbes to
mineralize organic nitrogen into plant available form of nitrogen, and
usually measured with anaerobic or aerobic incubation methods. The
potential microbial activity is evaluated using a more-is-better
logistic curve with an optimum PMN value around 45 mg N /kg, following
the scoring function of the CASH model for soil health. When PMN is not
measured, it is estimated from the total N content (being the main
driver for the potential mineralization rate as being determined with
the PMN text). The pedotransfer function an the scoring evaluation is
illustrated below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># built on the large dataset of Dutch soils (R2 = 0.79, N=109.146 samples)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">PMN</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.440931</span> <span class="op">+</span> <span class="fl">1.1012449</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">A_N_RT</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.055858</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># convert to OSI score</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="fu"><a href="../reference/osi_evaluate_logistic.html">osi_evaluate_logistic</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">PMN</span>,b <span class="op">=</span> <span class="fl">0.2</span>, x0 <span class="op">=</span> <span class="fl">20</span>,v <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Lets show a real example given the OSI farm data in the euosi
package. We first read the properties of the fields belonging to that
farm, and then estimate the soil health index for nitrogen using the
European assessment functions. The dataset contains soil properties from
60 agricultural fields and is documented in <code><a href="../reference/osi_farm.html">?osi_farm</a></code>. When
interested, look to the <code>summary</code> of the
<code>osi_farm</code> object.</p>
<p>Suprisingly the soil health index score is very high for both
indicators: for the set samples it is around 0.99, being almost equal to
the maximum score. This requires further evaluation in view of the
assumptions made for the virtual farm or the actual variation across
Europe.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># read the data from the OSI farm</span></span>
<span>  <span class="va">dt.of</span> <span class="op">&lt;-</span> <span class="fu">copy</span><span class="op">(</span><span class="fu">euosi</span><span class="fu">::</span><span class="va"><a href="../reference/osi_farm.html">osi_farm</a></span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># estimate the soil health score for the N supplying capacity</span></span>
<span>  <span class="va">dt.of</span><span class="op">[</span>, <span class="va">osi_c_n</span> <span class="op">:=</span> <span class="fu"><a href="../reference/osi_c_nitrogen_eu.html">osi_c_nitrogen_eu</a></span><span class="op">(</span>B_LU <span class="op">=</span> <span class="va">B_LU</span>, A_CLAY_MI <span class="op">=</span> <span class="va">A_CLAY_MI</span>, </span>
<span>                                       A_SAND_MI <span class="op">=</span> <span class="va">A_SAND_MI</span>,A_SOM_LOI <span class="op">=</span> <span class="va">A_SOM_LOI</span>, A_C_OF <span class="op">=</span> <span class="va">A_C_OF</span>, </span>
<span>                                       A_N_RT <span class="op">=</span> <span class="va">A_N_RT</span>, B_COUNTRY <span class="op">=</span> <span class="va">B_COUNTRY</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate the soil health score for microbial activity</span></span>
<span>  <span class="co"># for this example, total N is reduced with 50% to see some variation in the boxplot</span></span>
<span>  <span class="va">dt.of</span><span class="op">[</span>, <span class="va">osi_b_n</span> <span class="op">:=</span> <span class="fu"><a href="../reference/osi_b_pmn_eu.html">osi_b_pmn_eu</a></span><span class="op">(</span>B_LU <span class="op">=</span> <span class="va">B_LU</span>, A_CLAY_MI <span class="op">=</span> <span class="va">A_CLAY_MI</span>, A_N_RT <span class="op">=</span> <span class="va">A_N_RT</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="co"># show a boxplot for both PMN and N supplying capacity</span></span>
<span>  <span class="va">dt.melt</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dt.of</span>,id.vars<span class="op">=</span><span class="st">'ID'</span>,measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'osi_c_n'</span>,<span class="st">'osi_b_n'</span><span class="op">)</span>,<span class="op">)</span></span>
<span>  <span class="va">dt.melt</span><span class="op">[</span>,<span class="va">value</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span>,by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ID'</span>,<span class="st">'variable'</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># rename</span></span>
<span>  <span class="va">dt.melt</span><span class="op">[</span>,<span class="va">variable</span><span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">variable</span>,</span>
<span>                             levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'osi_c_n'</span>,<span class="st">'osi_b_n'</span><span class="op">)</span>,</span>
<span>                             labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'nitrogen\nsupply'</span>,<span class="st">'microbial\nactivity'</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="co"># plot a boxplot</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">dt.melt</span>,<span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">variable</span>,x<span class="op">=</span><span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>         <span class="fu">geom_boxplot</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">'#238b45'</span>,alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">''</span><span class="op">)</span><span class="op">+</span><span class="fu">ylab</span><span class="op">(</span><span class="st">'shi score'</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20EU3-1.png" alt="Evaluation N-indicator for Europe." width="75%"><p class="caption">
Evaluation N-indicator for Europe.
</p>
</div>
</div>
<div class="section level2">
<h2 id="austria-at">Austria (AT)<a class="anchor" aria-label="anchor" href="#austria-at"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="belgium-be">Belgium (BE)<a class="anchor" aria-label="anchor" href="#belgium-be"></a>
</h2>
<p>In Belgium, the capacity of soils to supply N is calculated
(<code>osi_c_nitrogen_be</code>) using an empirical algorithm. First,
the potentially available N pool is estimated as a function of total N
and the bulk density. Second, the mineralization of this N pool is
estimated as a function of the clay and carbonate content. The equation
is illustrated below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># estimate bulk density</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">BD</span> <span class="op">:=</span> <span class="fl">0.80806</span> <span class="op">+</span> <span class="fl">0.823844</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.0578</span><span class="op">*</span><span class="fl">0.1</span><span class="op">*</span><span class="va">A_C_OF</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.0014065</span> <span class="op">*</span> <span class="va">A_SAND_MI</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.0010299</span> <span class="op">*</span> <span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate helper variables</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="va">D_NHA</span> <span class="op">:=</span> <span class="va">A_N_RT</span> <span class="op">*</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">BD</span> <span class="op">*</span> <span class="fl">10000</span> <span class="op">*</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="va">D_NSC</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">22</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">12</span><span class="op">+</span><span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">545</span><span class="op">+</span><span class="va">A_CACO3_IF</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">D_NHA</span> <span class="op">*</span> <span class="fl">21.35</span> <span class="op">*</span> <span class="fl">0.33</span><span class="op">]</span></span></code></pre></div>
<p>The N supplying capacity is subsequently evaluated using a parabolic
evaluation function, being different for grassland and arable crops. The
optimum is set on 100 kg N/ha for cropland and on 140 kg/ha for
grassland. Note that the thresholds are set equal to France (might be
updated later). <br> When applied for a potato crop (code = 906) and
grassland (code = 745) and a series of soils varying in total N content,
we illustrate that the soil health index for the N supplying capacity
varies from zero (in the case that no N is present, assuming an
unrealistic high CN ratio) up to the maximum score when the total N
content is around 1500 mg N/kg for potato and around 2000 mg N/kg for
grassland.</p>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20BE2-1.png" alt="Evaluation N-indicator for Belgium." width="75%"><p class="caption">
Evaluation N-indicator for Belgium.
</p>
</div>
</div>
<div class="section level2">
<h2 id="switzerland-ch">Switzerland (CH)<a class="anchor" aria-label="anchor" href="#switzerland-ch"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="czech-republic-cz">Czech Republic (CZ)<a class="anchor" aria-label="anchor" href="#czech-republic-cz"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="germany-dk">Germany (DK)<a class="anchor" aria-label="anchor" href="#germany-dk"></a>
</h2>
<p>For Germany the N fertilizer recommendation system is essentially a N
balance calculation starting with the so called <code>N-Sollwert</code>,
being the nitrogen requirement of the crop. The term “Sollwert”
expresses the optimum (inorganic) nitrogen content in soil desired for
achieving maximum yield performance under a given set of agronomic
conditions. The N-Sollwert is derived from extensive field trials
establishing the N needs of various crops under normal conditions, after
which additions and deductions due to considerations of other factors
are made (e.g. presence of stones in soil). More information can be
found <a href="https://www.tll.de/www/daten/publikationen/schriftenreihe/dung0108.pdf" class="external-link">here</a>.In
sort, the N-sollwert is adjusted for the level of inorganic N at the
start of the growing season, the capacity of soils to supply N, and crop
related N inputs during the season. In more detail:</p>
<ul>
<li>measure Nmin: The existing inorganic nitrogen in soil is subtracted
from the reference set point (i.e. the desired N level in the soil,
according to the crops’ optimal N condition to achieve optimal
yield).</li>
<li>soil characteristics, including texture, organic matter composition,
and potential for mineralisation, significantly affect the dynamics of
nitrogen, and hence are taken into account to adjust the
N-Sollwert.</li>
<li>crop rotation and residues: The residual nitrogen contributions from
previous crops, mainly legumes, and organic fertilisers need to be
subtracted from the N-Sollwert as well. <br> Note that the crop codes
for Germany are not yet available in <code>osi_crops</code> package
table. So, regarding the assessment of soil N supply, there is currently
not a crop specific evaluation. <br> The implementation of this
calculation in <code>euosi</code> is done as follows:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># add soil type based deduction factor, with stype being dependent on clay, sand and SOM content</span></span>
<span>  <span class="va">dt</span><span class="op">[</span><span class="va">stype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'BG1'</span>,<span class="st">'BG2'</span><span class="op">)</span>, <span class="va">cf1</span> <span class="op">:=</span> <span class="fl">0.25</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span><span class="va">stype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'BG3'</span>,<span class="st">'BG4'</span><span class="op">)</span>, <span class="va">cf1</span> <span class="op">:=</span> <span class="fl">0.50</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span><span class="va">stype</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'BG5'</span><span class="op">)</span>, <span class="va">cf1</span> <span class="op">:=</span> <span class="fl">0.25</span><span class="op">]</span></span>
<span>  <span class="va">dt</span><span class="op">[</span><span class="va">stype</span> <span class="op">==</span> <span class="st">'BG6'</span>, <span class="va">cf1</span> <span class="op">:=</span> <span class="fl">0</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate bulk density via pedotransfer function</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">BD</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">0.02525</span> <span class="op">*</span> <span class="va">A_SOM_LOI</span> <span class="op">+</span> <span class="fl">0.6541</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># set annual decomposition rate of 2%</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">arate</span> <span class="op">:=</span> <span class="fl">0.02</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># estimate N supply for top 30 cm soil layer</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSC</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">100</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">*</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">BD</span><span class="op">)</span> <span class="op">*</span> <span class="va">A_N_RT</span> <span class="op">*</span> <span class="va">arate</span> <span class="op">*</span> <span class="fl">0.001</span> <span class="op">*</span> <span class="fl">0.001</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># assume that 25% is mineralized in winter, and available in pre-season</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSCPS</span> <span class="op">:=</span> <span class="fl">0.25</span> <span class="op">*</span> <span class="va">NSC</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># correction per soil type (being related to losses)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">NSCPS</span> <span class="op">:=</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span> <span class="va">cf1</span><span class="op">)</span> <span class="op">*</span> <span class="va">NSCPS</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># evaluate soil health score for NSC calculation (optimum around 100 kg N supply / ha)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">value</span> <span class="op">:=</span> <span class="fu"><a href="../reference/osi_evaluate_logistic.html">osi_evaluate_logistic</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">NSCPS</span>, b <span class="op">=</span>   <span class="fl">0.13683559</span>, x0 <span class="op">=</span> <span class="op">-</span><span class="fl">14.84508232</span>, v <span class="op">=</span>  <span class="fl">0.03487421</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>When applied on a sandy and clay soil in Germany, for soils with a CN
ratio varying between 8 and (unrealistic) value of 40 to illustrate how
the soil health index varies with total N in the soil. The soil health
index was optimum as soon as the N supply resulted in 40 kg N/ha in
spring. In these two examples illustrated this happens at soil N levels
around 2000 mg N/kg. Lowering the total N content (or increasing the CN
ratio) resulted in a declining soil index. The total N content is
evaluated as being more available for sandy soils than on clay
soils.</p>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20DE2-1.png" alt="Evaluation N-indicator for Germany." width="75%"><p class="caption">
Evaluation N-indicator for Germany.
</p>
</div>
</div>
<div class="section level2">
<h2 id="estonia-ee">Estonia (EE)<a class="anchor" aria-label="anchor" href="#estonia-ee"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="spain-es">Spain (ES)<a class="anchor" aria-label="anchor" href="#spain-es"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="finland-fi">Finland (FI)<a class="anchor" aria-label="anchor" href="#finland-fi"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="france-fr">France (FR)<a class="anchor" aria-label="anchor" href="#france-fr"></a>
</h2>
<p>In France, the capacity of soils to supply N is calculated
(<code>osi_c_nitrogen_fr</code>) using an empirical algorithm. First,
the potentially available N pool is estimated as a function of total N
and the bulk density. Second, the mineralization of this N pool is
estimated as a function of the clay and carbonate content. The equation
is illustrated below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># calculate derivative supporting soil properties: bulk density and N pool (kg N / ha)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">BD</span> <span class="op">:=</span> <span class="fl">0.80806</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0.823844</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.0578</span><span class="op">*</span><span class="fl">0.1</span><span class="op">*</span><span class="va">A_C_OF</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">0.0014065</span> <span class="op">*</span> <span class="va">A_SAND_MI</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fl">0.0010299</span> <span class="op">*</span> <span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">]</span> </span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_NHA</span> <span class="op">:=</span> <span class="va">A_N_RT</span> <span class="op">*</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">BD</span> <span class="op">*</span> <span class="fl">10000</span> <span class="op">*</span> <span class="fl">1000</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">-</span><span class="fl">6</span><span class="op">]</span>  </span>
<span>  </span>
<span>  <span class="co"># calculate the N supplying capacity for France (kg N/ha/yr)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>, <span class="va">D_NSC</span> <span class="op">:=</span> <span class="op">(</span><span class="op">(</span><span class="fl">22</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="fl">12</span><span class="op">+</span><span class="va">A_CLAY_MI</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">545</span><span class="op">+</span><span class="va">A_CACO3_IF</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">D_NHA</span><span class="op">)</span><span class="op">*</span><span class="fl">21.35</span> <span class="op">*</span> <span class="fl">0.33</span><span class="op">]</span></span></code></pre></div>
<p>The N supplying capacity is subsequently evaluated using a parabolic
evaluation function, being different for grassland and arable crops. The
optimum is set on 100 kg N/ha for cropland and on 140 kg/ha for
grassland. <br> When applied for a potato crop (code = PTC) and
grassland (code = PRL) and a series of soils varying in total N content,
we illustrate that the soil health index for the N supplying capacity
varies from zero (in the case that no N is present, assuming an
unrealistic high CN ratio) up to the maximum score when the total N
content is around 1500 mg N/kg for potato and around 2000 mg N/kg for
grassland.</p>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20FR2-1.png" alt="Evaluation N-indicator for France." width="75%"><p class="caption">
Evaluation N-indicator for France.
</p>
</div>
</div>
<div class="section level2">
<h2 id="hungary-hu">Hungary (HU)<a class="anchor" aria-label="anchor" href="#hungary-hu"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="ireland-ie">Ireland (IE)<a class="anchor" aria-label="anchor" href="#ireland-ie"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="italy-it">Italy (IT)<a class="anchor" aria-label="anchor" href="#italy-it"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="latvia-lv">Latvia (LV)<a class="anchor" aria-label="anchor" href="#latvia-lv"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="lithuania-lt">Lithuania (LT)<a class="anchor" aria-label="anchor" href="#lithuania-lt"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="netherlands-nl">Netherlands (NL)<a class="anchor" aria-label="anchor" href="#netherlands-nl"></a>
</h2>
<p>The nitrogen supply on grasslands is estimated based on the empirical
relationship of N supply and total N level, which also varies depending
on the sampling depth, soil texture and the age of the grassland. For
arable fields, the N supply is derived from a simple first order
decomposition model, calibrated for Dutch circumstances and depending on
soil texture, organic matter, and total N content. The total N supply is
evaluated via a parabolic scoring function with an optimum of 100 kg N
/ha in arable fields and 140 kg N /ha in grassland fields.</p>
<p>The euosi package implemented this in the function
<code>osi_c_nitrogen_nl</code>. This function requires the following
inputs:</p>
<ul>
<li>B_LU (character) The crop code</li>
<li>B_SOILTYPE_AGR (character) The soil type in a particular region</li>
<li>A_SOM_LOI (numeric) The organic matter content of the soil (%)</li>
<li>A_N_RT (numeric) The organic organic nitrogen content of the soil
(mg N / kg)</li>
</ul>
<p>An example is illustrated below for a maize crop (crop code 265) and
a single soil is:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># show an example for maize crop</span></span>
<span>  <span class="fu"><a href="../reference/osi_c_nitrogen_nl.html">osi_c_nitrogen_nl</a></span><span class="op">(</span>B_LU <span class="op">=</span> <span class="fl">265</span>, B_SOILTYPE_AGR <span class="op">=</span> <span class="st">'dekzand'</span>,</span>
<span>                    A_SOM_LOI <span class="op">=</span> <span class="fl">4</span>, A_N_RT <span class="op">=</span> <span class="fl">1050</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9551067</span></span></code></pre>
<p>Below the same example but then visualised for a series of soils with
a varying total N content and a fixed SOM content. This is done for two
crops: grassland and maize. From this example one can see that the soil
health index score is generally very high for grassland, and can by
quite variable for arable land.</p>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20NL2-1.png" alt="Evaluation N-indicator for the Netherlands." width="75%"><p class="caption">
Evaluation N-indicator for the Netherlands.
</p>
</div>
<p>The potential microbial activity is evaluated using a more-is-better
logistic curve with an optimum PMN value around 45 mg N / kg. Again, an
example is illustrated below for a maize crop (crop code 265):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># show an example for maize crop</span></span>
<span>  <span class="fu"><a href="../reference/osi_b_pmn_nl.html">osi_b_pmn_nl</a></span><span class="op">(</span>B_LU <span class="op">=</span> <span class="st">'265'</span>, B_SOILTYPE_AGR <span class="op">=</span> <span class="st">'dekzand'</span>,A_N_PMN <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.7183917</span></span></code></pre>
<p>When applied to a series of soils with varying PMN levels, an now for
potato and grassland, the soil health score looks as follows:</p>
<div class="figure">
<img src="eu_osi_for_nitrogen_files/figure-html/example%20NL4-1.png" alt="Evaluation PMN-indicator for the Netherlands." width="75%"><p class="caption">
Evaluation PMN-indicator for the Netherlands.
</p>
</div>
</div>
<div class="section level2">
<h2 id="norway-no">Norway (NO)<a class="anchor" aria-label="anchor" href="#norway-no"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="poland-pl">Poland (PL)<a class="anchor" aria-label="anchor" href="#poland-pl"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="sweden-se">Sweden (SE)<a class="anchor" aria-label="anchor" href="#sweden-se"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="slovak-republic-sk">Slovak Republic (SK)<a class="anchor" aria-label="anchor" href="#slovak-republic-sk"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="slovenia-sl">Slovenia (SL)<a class="anchor" aria-label="anchor" href="#slovenia-sl"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
<div class="section level2">
<h2 id="united-kingdom-uk">United Kingdom (UK)<a class="anchor" aria-label="anchor" href="#united-kingdom-uk"></a>
</h2>
<p>There is no country specific assessment for soil nitrogen yet, and
the European assessment is applied.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gerard Ros, Elise van Eynde, Sven Verweij.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
