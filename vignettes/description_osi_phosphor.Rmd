---
title: "Description of osi_phosphor"
author: 'Gerard Ros & Elise van Eynde'
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Description_osi_phosphor}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rmarkdown.html_vignette.check_title = FALSE

# require packages
require(euosi);require(data.table);require(ggplot2)
devtools::load_all()
```

## Introduction
Phosphorus (P) is an essential nutrient for crops and is applied to agricultural soil to bring or keep the soil at a certain target soil P status in view of an optimal crop yield. As such the P supply is a key aspect of soil health. Phosphorus in soil can be present as organic and inorganic P, with inorganic P typically contributing between 35 and 70% to total soil P. For soils receiving long-term inputs of P fertilizers and animal manures, the contribution of inorganic P to total soil P usually increases, as inorganic P is abundant in animal manures. Inorganic P includes phosphate sorbed to reactive soil particles (such as amorphous Fe- and Al-(hydr)oxides and oxidic clay mineral edges) and phosphate-bearing minerals. In the normal pH range of 5 to 8 of most agricultural soils, P sorption is the major mechanism controlling the P concentration in soil solution. The extent to which soils can sorb P depends on the maximum P sorption capacity which for non-calcareous soils relates to the amorphous Fe- and Al-(hydr)oxides contents.

Assessments of the soil health in view of phosphorus usually follow the agronomic Build-Up and Maintenance approach, where measured soil P contents are used to classify the soil P status, which is used to derive the best P fertilizer strategy for a specific crop. With this approach, all agricultural soils ultimately reach a “target” soil P status being optimal for crop produciton. Currently, this target soil P status is determined by the economic optimization of crop yield at which the P fertilizer inputs equals crop P removal, although some countries recommend adding additional P to correct for “inevitable” P losses caused by a progressive shift of plant-available P to less available soil P forms and environmental P losses. The target soil P status currently corresponds to the P status at which over 90% of relative crop yield is achieved. This target soil P status is derived from long-term P fertilization experiments. 

Routine agronomic soil P tests have in common that they make use of extraction methods to determine a certain fraction of total soil P that is correlated to crop response. The extracted amount of P varies with the nature of the extraction solution and methodological factors such as soil pretreatment, the soil-to-solution ratio and the analytical technique used for P measurement. For measuring readily available P forms that can be taken up by the crop in the short-term, soil P tests (referred to as P intensity methods) such as the 0.01 M CaCl2 and the water extraction method can be used. For the measurement of labile or moderately strong bound P (referred to as P quantity methods), extractions with acid ammonium acetate-lactate (P-AL), Mehlich3 and sodium bicarbonate (P-Olsen) can be used.

The European Open Soil Index assesses the soil function for P supply using the agronomic knowledge base as being used in the various EU countries. The soil P supply is transformed into an unitless indicator score ranging between zero (poor quality) and one (optimum quality). This indicator score reflects the ‘distance to target’ (i.e. difference between the current and optimum situation, while ensuring that other soil functions are not limiting). The further it deviates from score 1, the poorer the soil function works. An indicator value of 0.5 approximately corresponds to the threshold level of the fertilization guidelines under which (additional) fertilization is
recommended (given the ‘buildup and maintenance’ approach as being implemented in
fertilizer recommendation systems). Overall, the indicator value can be interpreted as good (>0.75), sufficient (0.5-0.75), and poor (<0.5).

## Netherlands (NL)
The phosphorus supply for grassland and maize fields is quantified based on soil P reserves (determined with ammonium lactate extraction) and plant available P (determined with CaCl2 extraction), where the optimum P supply is derived from multiple field experiments across the Netherlands. For arable fields, the phosphorus supply is approximated with water-extractable P, which reflect P availability controlled by chemical sorption and desorption equilibria and affected by the iron and aluminum oxides content of soils. The P supply is evaluated with a more-is-better logistic scoring function, which reaches the maximum score when the phosphorus supply is around 4.8 (unitless index, for maize and grassland fields) and 45 (mg P2O5 per liter, for arable fields). More information for grasland and maize can be found [here](www.bemestingsadvies.nl) and for arable crops can be found [here](https://www.handboekbodemenbemesting.nl/bemestingsadviezen/fosfaat/).

In the euosi package the P indicator for the Netherlands can be estimated via `osi_c_phosphor_nl`. This function requires the following inputs:
* B_LU, being the Dutch BRP code, an unique number for each crop
* A_P_AL, being the extracted P content with ammonium lactate, unit mg P /kg (internally converted to the unit mg P2O5/100g as being used in the Dutch context).
* A_P_CC, being the extracted P content with 0.01M CaCl2, unit mg P/kg.
* A_P_WA, being the extracted P content with water, unit mg P/kg (internally converted to the unit mg P2O5/L as being used in the Dutch context).

An example is illustrated below for a maize crop (crop code 265) and a single soil is:


```{r example NL1, echo = TRUE}

# show an example for maize crop
osi_c_phosphor_nl(B_LU = 265, A_P_AL = 197, A_P_CC = 2.5)

```

Below the same example but then visualised for a series of soils with a single P-AL value (of 45 mg P2O5/100g) and a variable P-CaCl2 value (ranging from 0.1 to 10 mg P /kg). This is done for two crops: grassland and maize. From this example one can see that the soil health index score varies from very low to very high, depending on the content of P-CaCl2.

```{r example NL2, out.width="75%", fig.cap="Evaluation P-indicator for the Netherlands.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-CaCl2 and a fixed P-AL
dt <- CJ(B_LU = c(259,265),
         A_P_AL = 197, 
         A_P_WA = 15,
         A_P_CC = seq(0.1,4,0.05))
dt[,landuse := fifelse(B_LU==259,'maize','grassland')]
dt[,osi_c_p := osi_c_phosphor_nl(B_LU,A_P_AL = A_P_AL,A_P_CC = A_P_CC,A_P_WA=A_P_WA)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_CC, xpar_label = 'P-CaCl2 (mg P/kg)',pgroup = dt$landuse)

```


## Belgium (Flanders)
The phosphorus supply in Belgium is based on the P level in soil being extracted with ammonium lactate. There is also a distinction between cropland or grassland with a higher optimum threshold value for grassland than cropland. More information of the optimum threshold values and the soil P status evaluation can be found [here](https://www.rundveeloket.be/sites/default/files/inline-files/ILVO%20mededeling%20195%20fosforreeks%20deel%201.pdf). In the euosi package the soil health score for P supply can be calculated with `osi_c_phosphor_be`, requiring the following inputs:
* B_LU, being the Belgium crop code, an unique number for each crop
* A_P_AL, being the extracted P content with ammonium lactate, unit mg P /kg (internally converted to the unit mg P/100g as being used in the Belgium context).

An example is illustrated below for a sugar beet crop (crop code 91) and a grassland (code = 60) for a single soil with P-content of 25 mg P / 100g:


```{r example BE1, echo = TRUE}

# show an example for sugar beet crop (code = 91) and grassland (code = 60)
c(osi_c_phosphor_be(B_LU = '91', A_P_AL = 250),
  osi_c_phosphor_be(B_LU = '60', A_P_AL = 250))

```
Below the same example but then visualised for a series of soils with a  P-AL value ranging from 0 to 300 mg P per kg (equal to 0 to 30 mg P/100g) for two crops: grassland and sugar beet. From this example one can see that the soil health index score varies from very low to very high, depending on the content of P-AL (mg P/kg).

```{r example BE2, out.width="75%", fig.cap="Evaluation P-indicator for the Belgium.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-AL content for two crops
dt <- CJ(B_LU = c(91,60),
         A_P_AL = seq(1,300,10))
dt[,landuse := fifelse(B_LU==91,'sugar beet','grassland')]
dt[,osi_c_p := osi_c_phosphor_be(B_LU,A_P_AL = A_P_AL)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_AL, xpar_label = 'P-AL (mg P/kg)',pgroup = dt$landuse)

```


## France (FR)
In France, soil phosphorus status for crop production is determined by assessing plant-available phosphorus levels, using the Olsen excration method. This soil P pool is then compared against thresholds specific to different crops, which vary based on factors like soil type and climate. In France the P supply can be assessed with varying degree of detail depending on the availability of regional threshold values. More information of the optimum threshold values and the soil P status evaluation can be found [here](https://comifer.asso.fr/wp-content/uploads/2015/03/COMIFER_RAPPORT_fertilisation_15102019.pdf).

The euosi package the soil health score for P supply can be calculated with `osi_c_phosphor_fr`, requiring the following inputs:
* B_LU, being the French crop code, an unique code for each crop
* A_P_OL, being the extracted P content with Olsen method, unit mg P /kg.
* A_PH_WA, being the soil acidity measured in water. 
The soil pH is used to distinghuish between calcareous and non-calcareous soils. If not given, then the function assumes the soil is not calcareous.

If one likes to adress the regional differences, it is also possible to add the agroeconomic region in France (argument `B_AER_FR`) and the agricultural soil type (argument `B_SOILTYPE_AGR`). These two arguments are optional. There are 40 soil types that can be selected (see below for the exact types possible). 

```{r table FR1, echo = FALSE}

 # show the available French soil types
  dt.soiltype <- as.data.table(euosi::osi_soiltype)
  dt.soiltype <- dt.soiltype[osi_country=='FR',.(osi_soil_id,type = osi_soil_cat1)]
  dt.soiltype <- cbind(dt.soiltype[c(1:13,NA),.(type)],
                       dt.soiltype[c(14:26,NA),.(type)],
                       dt.soiltype[27:40,.(type)])

  # print table
  knitr::kable(dt.soiltype,align='c',caption='Soil types used for P soil health assessment.')
```


For more information on the possible regions, see the table below.

```{r table FR2, echo = FALSE}

 # show the available French agricultural regions
 dt.thresholds <- as.data.table(euosi::osi_thresholds)
 dt.thresholds <- dt.thresholds[osi_country == 'FR' & osi_indicator =='i_c_p']
 dt.thresholds <- unique(dt.thresholds[!is.na(osi_threshold_region),.(region = osi_threshold_region)])
 dt.thresholds <- cbind(dt.thresholds[1:4],
                        dt.thresholds[5:8],
                        dt.thresholds[9:13],
                        dt.thresholds[14:16])

  # print table
  knitr::kable(dt.thresholds,align='c',caption='French regions used for P soil health assessment.')
```


An example of the `osi_c_phosphor_fr` function is illustrated below for potato (crop code PTC) and permanent grassland (code = PRL) for a single soil with P-content of 20 mg P / kg. 


```{r example FR1, echo = TRUE}

# show an example for soil P asssesment for sugar beet crop (code = 91) and grassland (code = 60)
c(osi_c_phosphor_fr(B_LU = 'PTC', A_P_OL = 20),
  osi_c_phosphor_fr(B_LU = 'PRL', A_P_OL = 20))

# show an example with regional information available
osi_c_phosphor_fr(B_LU = 'SOJ', A_P_OL = 45, 
                  B_SOILTYPE_AGR = 'limons battants', 
                  B_AER_FR = 'nord-picardie')
```

Below the same example but then visualised for a series of soils with a P-Olsen value ranging from 0 to 30 mg P per kg (equal to 0 to 69 mg P2O5 /kg) for two crops: grassland and potato. From this example one can see that the soil health index score varies from very low to very high, depending on the content of P-Olsen (mg P/kg).

```{r example FR2, out.width="75%", fig.cap="Evaluation P-indicator for the France.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-Olsen content
dt <- CJ(B_LU = c('PTC','PRL'),
         A_P_OL = seq(1,30,0.5),
         A_PH_WA = 7.5)
dt[,landuse := fifelse(B_LU=='PTC','potato','grassland')]
dt[,osi_c_p := osi_c_phosphor_fr(B_LU,A_P_OL = A_P_OL, A_PH_WA = A_PH_WA)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_OL, xpar_label = 'P-Olsen (mg P/kg)',pgroup = dt$landuse)

```

## Austria (AT)
The phosphorus supply in view of soil health can be calculated using `osi_c_phosphor_at` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_P_CAL, being the extracted P content with calcium ammonium lactate, unit mg P /kg.
The soil P threshold for optimum soil health is generic for all soil types but differs between arable land and grassland. The optimum threshold is set around 47-68 mg P/kg for grassland and around 47-111 mg P/kg for cropland. More information can be found in the article of Bohner et al. (2013), that can be downloaded [here](https://raumberg-gumpenstein.at/jdownloads/Forschungsberichte/Umweltressourcen_im_Gruenland/Naehrstoffe/2_2013_INTERREG_IV_Projekt_Abschlussbericht_gewaesserzukunft_Bohner.pdf) with a reference to the publication entitled RICHTLINIEN FÜR DIE SACHGERECHTE DÜNGUNG, 2006: Anleitung zur Interpretation von Bodenuntersuchungsergebnissen in der Landwirtschaft. 6. Aufl. Bundesministerium für Land- und Forstwirtschaft,
Umwelt und Wasserwirtschaft, 80 S that can be found [here](https://www.bmluk.gv.at/dam/jcr:6e638ac4-6dd2-441d-8e51-9304966230cf/Richtlinien%20f%C3%BCr%20die%20sachgerechte%20D%C3%BCngung%20im%20Ackerbau%20und%20Gr%C3%BCnland_akt.pdf).

Note that the crop codes are not yet available in `osi_crops` package table. There is a temporary fix that B_LU codes with the string "grass" are considered as grassland whereas all others are considered cropland. 

```{r example AT1, out.width="75%", fig.cap="Evaluation P-indicator for Austria.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-CAL content
dt <- CJ(B_LU = c('grassland','potato'),
         A_P_CAL = seq(1,100,5))
dt[,osi_c_p := osi_c_phosphor_at(B_LU,A_P_CAL = A_P_CAL)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_CAL, xpar_label = 'P-CAL (mg P/kg)',pgroup = dt$B_LU)

```


## Switzerland (CH)
The phosphorus supply in view of soil health for agricultural soils in Switzerland can be calculated using `osi_c_phosphor_ch` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_P_AAA, being the extracted P content with ammonium acetate, unit mg P /kg.

More information can be found in Flisch et al. (2017) entitled `Grundlagen für die Düngung landwirtschaftlicher Kulturen in der Schweiz`. This document can be downloaded [here](https://www.agroscope.admin.ch/agroscope/de/home/themen/pflanzenbau/ackerbau/Pflanzenernaehrung/grud.html)
Note that the crop codes are not yet available in `osi_crops` package table.  

Below an example is visualized how the soil health index varies in relation to variation in P-AAA. The optimum soil P threshold value for sustainable crop production is around 75 mg P/ kg, and the soil index decreases to zero when P-AAA values decreases down to 20 mg P/kg.


```{r example CH1, out.width="75%", fig.cap="Evaluation P-indicator for Switzerland.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-AAA content
dt <- CJ(B_LU = c('cropland'),
         A_P_AAA = seq(1,75,1))
dt[,osi_c_p := osi_c_phosphor_ch(B_LU,A_P_AAA = A_P_AAA)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_AAA, xpar_label = 'P-AAA (mg P/kg)',pgroup = NULL)

```


## Czech Republic (CZ)
The phosphorus supply in view of soil health for agricultural soils in Czech Republic can be calculated using `osi_c_phosphor_cz` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_P_M3, being the extracted P content with Mehlich-III, unit mg P /kg.

Information on the threshold values for P-Mehlich in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Czech Republic are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P Mehlich-III. The optimum soil P threshold value for sustainable crop production is around 125 mg P/ kg, and the soil index rapidly decreases to zero when P Mehlich-III values decreases down to 50 mg P/kg.


```{r example CZ1, out.width="75%", fig.cap="Evaluation P-indicator for Czech Republic.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-M3 content
dt <- CJ(B_LU = c('cropland'),
         A_P_M3 = seq(1,200,5))
dt[,osi_c_p := osi_c_phosphor_cz(B_LU,A_P_M3 = A_P_M3)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_M3, xpar_label = 'P-M3 (mg P/kg)',pgroup = NULL)

```


## Germany (DE)
The phosphorus supply in view of soil health for agricultural soils in Germany can be calculated using `osi_c_phosphor_de` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_SOM_LOI, being the soil organic matter content, in units percentage (\%)
* A_P_CAL, being the extracted P content with calcium ammonium lactate, unit mg P /kg (internally converted to the common unit mg P /100g for mineral soils and mg P/100 ml for peat soils, as being used in German fertilizer recommendation systems).
* A_P_DL, being the extracted P content with double lactate, unit mg P/kg, optional.

The P supplying capacity differ for soils varying in clay content and distinghuises also between peaty and mineral soils. Information on the threshold values for P-CAL in view of sustainable crop production has been derived by the VDLUFA. In 2020 the threshold values have been updated. For more information, see [here](https://www.lufa-nord-west.de/index.cfm/action/downloadcenter?file=08E6CC) 

Note that the crop codes for Germany are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-AL. The optimum soil P threshold value for sustainable crop production is around 60 mg P/ kg for peat soils and around 100 mg P/kg for mineral soils. The soil index decreases when P-AL values decreases down to 20 mg P/kg (peat soils) or 50 mg P/kg (mineral soils).


```{r example DE1, out.width="75%", fig.cap="Evaluation P-indicator for Germany.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-CAL content for three soil types
dt <- CJ(B_LU = c('cropland'),
         A_SOM_LOI = c(5,10,20),
         A_P_CAL = seq(1,130,5))
dt[A_SOM_LOI==5,A_CLAY_MI := 10]
dt[A_SOM_LOI > 5,A_CLAY_MI := 5]
dt[,stype := fifelse(A_SOM_LOI <= 8 ,'clay low humus',
             fifelse(A_SOM_LOI==10, 'sand high humus','peat'))]
dt[,osi_c_p := osi_c_phosphor_de(B_LU,A_P_CAL = A_P_CAL,A_SOM_LOI = A_SOM_LOI,A_CLAY_MI = A_CLAY_MI)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_CAL, xpar_label = 'P-CAL (mg P/kg)',pgroup = dt$stype)

```



## Denmark (DK)
The phosphorus supply in Denmark is based on the P level in soil being extracted with the Olsen method. There is no distinction between cropland or grassland or between soil types. The threshold values for optimum soil P levels are taken from the study of Knudsen & Schnug (2016), with the table found [here](https://link.springer.com/chapter/10.1007/978-94-017-7612-7_11/tables/2)

In the euosi package the soil health score for P supply can be calculated with `osi_c_phosphor_dk`, requiring the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_P_OL, being the extracted P content with Olsen, unit mg P /kg.

Note that the crop codes for Denmark are not yet available in `osi_crops` package table.

Below the same example but then visualised for a series of soils with a  P-Olsen value ranging from 0 to 70 mg P per kg. The optimum soil P threshold value for sustainable crop production is around 50 mg P/ kg for all soils. The soil index decreases when P-Olsen values decreases down to 30 mg P/kg.


```{r example DK1, out.width="75%", fig.cap="Evaluation P-indicator for the Belgium.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-Olsen
dt <- CJ(B_LU = c(91,60),
         A_P_OL= seq(1,75,1))
dt[,osi_c_p := osi_c_phosphor_dk(B_LU,A_P_OL = A_P_OL)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_OL, xpar_label = 'P-Olsen (mg P/kg)',pgroup = NULL)

```


## Estonia (EE)
The phosphorus supply in view of soil health for agricultural soils in Estonia can be calculated using `osi_c_phosphor_ee` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_SOM_LOI, being the soil organic matter content, in units percentage (\%)
* A_P_M3, being the extracted P content with Mehlich-III, unit mg P /kg.

The P supplying capacity differs in soils with high humus content (>2%) and for soils with low humus content (<2%). Information on the threshold values for P-Mehlich in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Estonia are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P Mehlich-III. The optimum soil P threshold value for sustainable crop production is around 75 mg P/ kg for both soil types (low and high in soil organic matter), and the soil index rapidly decreases when P Mehlich-III values decreases down to 5 (humus rich soils) or 25 (humus poor soils) mg P/kg.


```{r example EE1, out.width="75%", fig.cap="Evaluation P-indicator for Estonia.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-M3 content for two soil types
dt <- CJ(B_LU = c('cropland'),
         A_SOM_LOI = c(1.5,5.5),
         A_P_M3 = seq(1,100,5))
dt[,stype := fifelse(A_SOM_LOI <= 2,'humus low','humus rich')]
dt[,osi_c_p := osi_c_phosphor_ee(B_LU,A_P_M3 = A_P_M3,A_SOM_LOI = A_SOM_LOI)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_M3, xpar_label = 'P-M3 (mg P/kg)',pgroup = dt$stype)

```


## Spain (ES)

## Finland (FI)

## Hungary (HU)
The phosphorus supply in view of soil health for agricultural soils in Hungary can be calculated using `osi_c_phosphor_hu` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_SOM_LOI, being the soil organic matter content, in units percentage (\%)
* A_CLAY_MI, being the clay content, in units percentage (\%)
* A_CACO3_IF, being the carbonate content, in units percentage (\%)
* A_P_AL, being the extracted P content with ammonium lactate, unit mg P /kg.

The P supplying capacity differs between carbonate and acidic soils (depending on carbonate content), between soils high or low in soil organic matter (the chernozem and other soil types), and between soils varying in soil texture (i.e. brown forest and sandys oils).  Information on the threshold values for P-AL in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Hungary are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-AL. The optimum soil P threshold value for sustainable crop production is around 120 mg P/ kg for both soil types (peat and mineral soils), and the soil index rapidly decreases when P-AL values decreases down to 60 mg P/kg.


```{r example HU1, out.width="75%", fig.cap="Evaluation P-indicator for Hungary.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-AL content for two soil types
dt <- CJ(B_LU = c('cropland'),
         A_SOM_LOI = c(25,25),
         A_CACO3_IF = c(0.5,15),
         A_CLAY_MI = c(7.5,7.5),
         A_P_AL = seq(1,150,5))
dt[,stype := fifelse(A_SOM_LOI <= 20,'mineral soils','chernozem')]
dt[,stype := paste(stype,fifelse(A_CACO3_IF <5,' (pH < 6)',' (pH > 6)'))]
dt[,osi_c_p := osi_c_phosphor_hu(B_LU=B_LU,A_P_AL = A_P_AL,A_SOM_LOI = A_SOM_LOI,
                                 A_CLAY_MI= A_CLAY_MI,A_CACO3_IF=A_CACO3_IF)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_AL, xpar_label = 'P-AL (mg P/kg)',pgroup = dt$stype)

```


## Ireland (IE)

## Italy (IT)

## Latvia (LV)
The phosphorus supply in view of soil health for agricultural soils in Latvia can be calculated using `osi_c_phosphor_lv` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* B_TEXTURE_USDA, being the soil texture class according to USDA classification system
* A_P_DL, being the extracted P content with Double Lactate extraction, unit mg P /kg.

The P supplying capacity differs in soils with varying textures. Based on the soil mineralogy (clay, sand and silt content) one can easily classify the USDA texture class using `osi_get_TEXTURE_USDA`. Information on the threshold values for P-DL in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Latvia are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-DL. The optimum soil P threshold value for sustainable crop production is around 60 mg P/ kg for the three soil types evaluated (clay, sand and loam), and the soil index rapidly decreases when P-DL values decreases down to 10-20 mg P/kg.


```{r example LV1, out.width="75%", fig.cap="Evaluation P-indicator for Latvia.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-M3 content for two soil types
dt <- CJ(B_LU = c('cropland'),
         B_TEXTURE_USDA = c('Sa','Lo','Cl'),
         A_P_DL = seq(1,60,1))
dt[,stype := fifelse(B_TEXTURE_USDA=='Sa','sand',
                     fifelse(B_TEXTURE_USDA =='Cl','clay', 'loam'))]
dt[,osi_c_p := osi_c_phosphor_lv(B_LU,A_P_DL = A_P_DL,B_TEXTURE_USDA = B_TEXTURE_USDA)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_DL, xpar_label = 'P-DL (mg P/kg)',pgroup = dt$stype)

```

## Lithuania (LT)
The phosphorus supply in view of soil health for agricultural soils in Lithuania can be calculated using `osi_c_phosphor_lt` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_SOM_LOI, being the soil organic matter content, in units percentage (\%)
* A_P_AL, being the extracted P content with ammonium lactate, unit mg P /kg.

The P supplying capacity differs between peaty soils (having high levels of soil organic matter) and mineral soils. Information on the threshold values for P-AL in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Lithuania are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-AL. The optimum soil P threshold value for sustainable crop production is around 75 mg P/ kg for both soil types (peat and mineral soils), and the soil index rapidly decreases when P-AL values decreases down to 30 mg P/kg.


```{r example LT1, out.width="75%", fig.cap="Evaluation P-indicator for Lithuania.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-M3 content for two soil types
dt <- CJ(B_LU = c('cropland'),
         A_SOM_LOI = c(5,25),
         A_P_AL = seq(1,100,5))
dt[,stype := fifelse(A_SOM_LOI <= 20,'mineral soils','peat soils')]
dt[,osi_c_p := osi_c_phosphor_lt(B_LU,A_P_AL = A_P_AL,A_SOM_LOI = A_SOM_LOI)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_AL, xpar_label = 'P-AL (mg P/kg)',pgroup = dt$stype)

```


## Norway (NO)

## Poland (PL)

## Sweden (SE)

## Slovak Republic (SK)
The phosphorus supply in view of soil health for agricultural soils in Slovak Republic can be calculated using `osi_c_phosphor_lv` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* B_TEXTURE_HYPRES, being the soil texture class according to HYPRES classification system
* A_P_M3, being the extracted P content with Mehlich-III extraction, unit mg P /kg.

The P supplying capacity differs in soils with varying textures. Based on the soil mineralogy (clay, sand and silt content) one can easily classify the USDA texture class using `osi_get_TEXTURE_HYPRES`. Information on the threshold values for P-Mehlich in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Slovak Republic are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-M3. The optimum soil P threshold value for sustainable crop production is around 150 mg P/ kg for the three soil types evaluated (clay, sand and loam), and the soil index rapidly decreases when P-M3 values decreases down to 50-70 mg P/kg, with the quickest decline for the sandy soils (low in buffering capacity).


```{r example SK1, out.width="75%", fig.cap="Evaluation P-indicator for Slovak Republic.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P-M3 content for two soil types
dt <- CJ(B_LU = c('cropland'),
         B_TEXTURE_HYPRES = c('C','M','F'),
         A_P_M3 = seq(1,150,5))
dt[,stype := fifelse(B_TEXTURE_HYPRES=='C','sand',
                     fifelse(B_TEXTURE_HYPRES =='F','clay', 'loam'))]
dt[,osi_c_p := osi_c_phosphor_sk(B_LU,A_P_M3 = A_P_M3,B_TEXTURE_HYPRES = B_TEXTURE_HYPRES)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_M3, xpar_label = 'P-M3 (mg P/kg)',pgroup = dt$stype)

```

## Slovenia (SL)
The phosphorus supply in view of soil health for agricultural soils in Slovenia can be calculated using `osi_c_phosphor_sl` using the following inputs:
* B_LU, being the crop code, an unique number for each crop
* A_P_AL, being the extracted P content with Ammonium Lactate extraction, unit mg P/kg.

The P supplying capacity does not differ among soil types or crop types; there is a single optimum threshold defined for all agricultural land. Information on the threshold values for P-AL in view of sustainable crop production has been derived from Fotyma et al. (2008) who wrote a comprehensive overview of soil testing methods in Eastern Europe entitled "Soil testing methods and fertilizer recommendations in Central–Eastern European countries". 

Note that the crop codes for Slovenia are not yet available in `osi_crops` package table.

Below an example is visualized how the soil health index varies in relation to variation in P-AL. The optimum soil P threshold value for sustainable crop production is around 80 mg P/ kg for the three soil types evaluated (clay, sand and loam), and the soil index rapidly decreases when P-AL values decreases down to 30 mg P/kg.


```{r example SL1, out.width="75%", fig.cap="Evaluation P-indicator for Slovenia.",fig.height = 2,dpi=300, echo = FALSE}

# make an example with varying P content
dt <- CJ(B_LU = c('cropland'),
         A_P_AL = seq(1,120,1))
dt[,osi_c_p := osi_c_phosphor_sl(B_LU,A_P_AL = A_P_AL)]

# show plot
osi_plot_shi(shi = dt$osi_c_p, xpar = dt$A_P_AL, xpar_label = 'P-AL (mg P/kg)',pgroup = NULL)

```

## United Kingdom (UK)



